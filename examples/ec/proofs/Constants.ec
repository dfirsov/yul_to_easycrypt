require import AllCore Int IntDiv Gcd_props AlmostYUL.


hint simplify expr0@1.
lemma powS_minus (x p:int) : 0 < p => x ^ p  = x * x ^ (p-1).
proof. smt (exprS). qed.
hint simplify powS_minus@1.



op _MONTGOMERY_THREE = 19052624634359457937016868847204597229365286637454337178037183604060995791063.
op _P = 21888242871839275222246405745257275088696311157297823662689037894645226208583.
op _R2_MOD_P = 3096616502983703923843567936837374451735540968419076528771170197431451843209.
op _N_PRIME = 111032442853175714102588374283752698368366046808579839647964533820976443843465.
op _R = 2^256.

lemma R2_MOD_P_correct : (_R * _R) %% _P = _R2_MOD_P by []. 
lemma _MONTGOMERY_THREE_correct : (3 * _R) %% _P = _MONTGOMERY_THREE by []. 
lemma _N_PRIME_correct : (_N_PRIME * _P) %% _R = (-1) %% _R by []. 

